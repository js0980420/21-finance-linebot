import vt from"./-Op9ZE8F.js";import{_ as ht,r as g,b as pe,H as W,y as kt,i as wt,C as Ut,u as Vt,c as r,a as o,e as T,x as b,j as w,d as l,k as v,f as S,g as p,I as U,v as m,F as x,q as f,G as Oe,t as c,l as ve,J as Ct,o as i,A as Lt,K as B,s as Q,L as G,n as qe,h as It}from"#entry";import{_ as St,r as Nt}from"./CRGlAI26.js";import{u as he}from"./CaSEveCJ.js";import{u as Et}from"./l19cjJOa.js";import{u as Dt}from"./CuXVLCuF.js";import{u as jt}from"./DdqGq6Yh.js";import{u as $t,a as ke}from"./DgLT0ASK.js";import{u as At}from"./BtlpaPqX.js";import{u as Ot}from"./7WFD-W98.js";import{u as qt}from"./DzJdZt_Q.js";import{u as Mt}from"./DQZituR6.js";import{r as Tt}from"./UqRq4KLf.js";import{r as Ft}from"./BKE9UY2T.js";import{r as Pt}from"./DdngC8ig.js";import{r as Rt}from"./c8JhvyFk.js";import"./B5My0XuL.js";import"./CKtbBPOe.js";const zt={class:"space-y-6"},Wt={class:"flex items-center justify-between"},Bt=["value"],Gt=["value","onChange"],Ht=["value"],Xt={class:"text-sm font-medium text-gray-900"},Jt=["value","onChange"],Kt=["value"],Qt=["value","onChange"],Yt={class:"text-sm text-gray-900"},Zt={class:"text-xs text-gray-500"},eo={class:"flex items-center space-x-2"},to={class:"text-sm text-gray-900"},oo=["onClick"],lo={class:"text-sm text-gray-900"},so={class:"text-xs text-gray-500"},ao={key:0,class:"flex items-center space-x-2"},no=["src","alt"],ro={key:1,class:"w-6 h-6 rounded-full bg-green-500 flex items-center justify-center text-white text-xs"},io={class:"flex-1 min-w-0"},uo={class:"flex items-center space-x-1"},co={class:"text-xs font-medium text-gray-900 truncate"},po=["onClick"],yo={key:1,class:"flex items-center space-x-2"},bo={class:"text-xs text-gray-900"},go={key:2,class:"text-xs text-gray-400"},mo={class:"text-sm text-gray-900"},_o={class:"text-xs text-gray-500 truncate max-w-[120px]"},xo={class:"text-sm text-gray-900"},fo=["value","onChange"],vo={key:0,class:"space-y-1"},ho={class:"text-gray-500"},ko={class:"text-gray-900 ml-1"},wo={key:0,class:"text-xs text-gray-400"},Uo={key:1,class:"text-xs text-gray-400"},Vo={class:"flex items-center space-x-2 justify-end"},Co=["onClick"],Lo=["onClick"],Io=["onClick"],So=["onClick"],No={class:"bg-white rounded-lg p-6 w-full max-w-3xl mx-4 max-h-[90vh] overflow-y-auto"},Eo=["value"],Do={class:"md:col-span-2"},jo=["value"],$o={class:"md:col-span-2 flex justify-end space-x-4 pt-4 border-t"},Ao=["disabled"],Oo={class:"bg-white h-full w-full overflow-hidden flex flex-col"},qo={class:"flex items-center justify-between p-6 border-b bg-gray-100"},Mo={class:"flex-1 overflow-hidden"},To={class:"flex-1 border-r overflow-y-auto p-6 bg-gray-50"},Fo={class:"space-y-4"},Po=["value"],Ro=["value"],zo=["value"],Wo={class:"space-y-2"},Bo=["value"],Go={class:"space-y-2"},Ho={class:"flex-1 border-r overflow-y-auto p-6 bg-gray-100"},Xo={class:"text-lg font-semibold text-gray-800 mb-4 sticky top-0 bg-gray-100 py-2"},Jo={class:"space-y-4"},Ko={class:"block text-sm font-semibold text-gray-900 mb-1"},Qo={key:0,class:"text-red-500"},Yo=["onUpdate:modelValue","type","readonly"],Zo=["onUpdate:modelValue"],el=["onUpdate:modelValue"],tl=["onUpdate:modelValue"],ol=["value"],ll={key:4,class:"inline-flex items-center space-x-2 mt-2"},sl=["onUpdate:modelValue"],al={key:5,class:"text-sm text-gray-500"},nl={class:"flex-1 border-r overflow-y-auto p-6 bg-gray-200"},rl={class:"text-lg font-semibold text-gray-800 mb-4 sticky top-0 bg-gray-200 py-2"},il={class:"space-y-4"},dl={class:"block text-sm font-semibold text-gray-900 mb-1"},ul={key:0,class:"text-red-500"},cl=["onUpdate:modelValue","type","readonly"],pl=["onUpdate:modelValue"],yl=["onUpdate:modelValue"],bl=["onUpdate:modelValue"],gl=["value"],ml={key:4,class:"inline-flex items-center space-x-2 mt-2"},_l=["onUpdate:modelValue"],xl={class:"flex-1 border-r overflow-y-auto p-6 bg-gray-50"},fl={class:"text-lg font-semibold text-gray-800 mb-4 sticky top-0 bg-gray-50 py-2"},vl={class:"space-y-4"},hl={class:"block text-sm font-semibold text-gray-900 mb-1"},kl={key:0,class:"text-red-500"},wl=["onUpdate:modelValue","type","readonly"],Ul=["onUpdate:modelValue"],Vl={key:2,class:"inline-flex items-center space-x-2 mt-2"},Cl=["onUpdate:modelValue"],Ll={class:"flex-1 border-r overflow-y-auto p-6 bg-gray-100"},Il={class:"text-lg font-semibold text-gray-800 mb-4 sticky top-0 bg-gray-100 py-2"},Sl={class:"space-y-4"},Nl={class:"block text-sm font-semibold text-gray-900 mb-1"},El={key:0,class:"text-red-500"},Dl=["onUpdate:modelValue","type","readonly"],jl={key:1,class:"inline-flex items-center space-x-2 mt-2"},$l=["onUpdate:modelValue"],Al={class:"flex-1 overflow-y-auto p-6 bg-gray-200"},Ol={class:"text-lg font-semibold text-gray-800 mb-4 sticky top-0 bg-gray-200 py-2"},ql={class:"space-y-4"},Ml={class:"block text-sm font-semibold text-gray-900 mb-1"},Tl={key:0,class:"text-red-500"},Fl=["onUpdate:modelValue","type","readonly"],Pl=["onUpdate:modelValue"],Rl={key:0,class:"border-t pt-4"},zl={class:"space-y-4"},Wl={class:"block text-sm font-semibold text-gray-900 mb-1"},Bl={key:0,class:"text-red-500"},Gl=["type","step","required","onUpdate:modelValue"],Hl=["required","onUpdate:modelValue"],Xl=["required","onUpdate:modelValue"],Jl=["value"],Kl={key:3},Ql={class:"flex flex-wrap gap-2"},Yl=["value","onUpdate:modelValue"],Zl={key:4,class:"inline-flex items-center space-x-2 mt-2"},es=["onUpdate:modelValue"],ts={class:"border-t pt-4"},os={class:"border-t pt-4 flex justify-end space-x-3"},ls=["disabled"],ss={class:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto"},as={key:0,class:"space-y-4"},ns={class:"grid grid-cols-2 gap-4"},rs={class:"text-gray-900"},is={class:"text-gray-900"},ds={class:"text-gray-900"},us={class:"text-gray-900"},cs={class:"text-gray-900"},ps={class:"text-gray-900"},ys={key:0},bs={class:"text-gray-900 whitespace-pre-wrap"},gs={class:"bg-white rounded-lg p-6 w-full max-w-lg"},ms={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},_s={class:"md:col-span-2"},xs={class:"bg-white rounded-lg p-6 w-full max-w-md"},fs={key:0,class:"mb-4"},vs={class:"bg-gray-50 p-3 rounded-lg"},hs={class:"text-sm text-gray-900"},ks={class:"text-sm text-gray-900"},ws={class:"text-sm text-gray-900"},Us=["value"],Vs={class:"flex justify-end space-x-3 pt-4"},Cs=["disabled"],Ls={class:"bg-white rounded-lg p-6 w-full max-w-md"},Is={key:0,class:"mb-4"},Ss={class:"bg-gray-50 p-3 rounded-lg flex items-center space-x-3"},Ns=["src","alt"],Es={key:1,class:"w-10 h-10 rounded-full bg-green-500 flex items-center justify-center text-white text-sm"},Ds={class:"text-sm text-gray-900 font-medium"},js={class:"text-xs text-gray-500"},$s={class:"flex justify-end space-x-3 pt-4"},As=["disabled"],Os={__name:"index",setup(qs){const ye=[{value:"pending",label:"待處理",category:"leads"},{value:"valid_customer",label:"有效客",category:"leads_management"},{value:"invalid_customer",label:"無效客",category:"leads_management"},{value:"customer_service",label:"客服",category:"leads_management"},{value:"blacklist",label:"黑名單",category:"leads_management"},{value:"approved_disbursed",label:"核准撥款",category:"case_management"},{value:"approved_undisbursed",label:"核准未撥",category:"case_management"},{value:"conditional_approval",label:"附條件",category:"case_management"},{value:"declined",label:"婉拒",category:"case_management"},{value:"tracking",label:"追蹤中",category:"sales_tracking"}],Me=[{key:"case_status",title:"進線狀態",sortable:!0,width:"90px"},{key:"datetime",title:"時間",sortable:!0,width:"140px"},{key:"assignee",title:"承辦業務",sortable:!0,width:"80px"},{key:"channel",title:"來源管道",sortable:!0,width:"80px"},{key:"customer_name",title:"姓名",sortable:!0,width:"80px"},{key:"line_info",title:"LINE資訊",sortable:!1,width:"160px"},{key:"purpose",title:"諮詢項目",sortable:!1,width:"100px"},{key:"website",title:"網站",sortable:!1,width:"50px"},{key:"contact_info",title:"聯絡資訊",sortable:!1,width:"160px"},{key:"actions",title:"操作",sortable:!1,width:"160px"}],N={personal:{title:"個人資料",fields:[{key:"birth_date",label:"出生年月日",type:"date"},{key:"id_number",label:"身份證字號",type:"text"},{key:"education",label:"最高學歷",type:"select",options:["國小","國中","高中職","專科","大學","碩士","博士"]}]},contact:{title:"聯絡資訊",fields:[{key:"region",label:"所在地區",type:"text"},{key:"registered_address",label:"戶籍地址",type:"text"},{key:"home_phone",label:"室內電話",type:"text"},{key:"address_same",label:"通訊地址是否同戶籍地",type:"boolean"},{key:"mailing_address",label:"通訊地址",type:"text"},{key:"mobile_phone",label:"通訊電話",type:"text"},{key:"residence_duration",label:"現居地住多久",type:"text"},{key:"residence_owner",label:"居住地持有人",type:"text"},{key:"telecom_provider",label:"電信業者",type:"select",options:["中華電信","台灣大哥大","遠傳電信","台灣之星","亞太電信"]}]},other:{title:"其他資訊",fields:[{key:"case_number",label:"進線編號",type:"text",readonly:!0},{key:"required_amount",label:"需求金額",type:"number"},{key:"custom_fields",label:"自定義欄位",type:"custom"}]},company:{title:"公司資料",fields:[{key:"company_email",label:"電子郵件",type:"email"},{key:"company_name",label:"公司名稱",type:"text"},{key:"company_phone",label:"公司電話",type:"text"},{key:"company_address",label:"公司地址",type:"text"},{key:"job_title",label:"職稱",type:"text"},{key:"monthly_income",label:"月收入",type:"number"},{key:"new_labor_insurance",label:"有無新轉勞保",type:"boolean"},{key:"employment_duration",label:"目前公司在職多久",type:"text"}]},emergency:{title:"緊急聯絡人",fields:[{key:"contact1_name",label:"聯絡人①姓名",type:"text"},{key:"contact1_relationship",label:"聯絡人①關係",type:"text"},{key:"contact1_phone",label:"聯絡人①電話",type:"text"},{key:"contact1_available_time",label:"方便聯絡時間",type:"text"},{key:"contact1_confidential",label:"是否保密",type:"boolean"},{key:"contact2_name",label:"聯絡人②姓名",type:"text"},{key:"contact2_relationship",label:"聯絡人②關係",type:"text"},{key:"contact2_phone",label:"聯絡人②電話",type:"text"},{key:"contact2_confidential",label:"是否保密",type:"boolean"},{key:"contact2_available_time",label:"方便聯絡時間",type:"text"},{key:"referrer",label:"介紹人",type:"text"}]}},Y=$t(),{success:L,error:_,confirm:be}=At(),{list:Te,updateOne:we,removeOne:Fe,convertToCase:Pe}=Et(),{getUsers:Re}=Ot();jt();const{list:ze}=qt(),{refreshBadges:H}=Mt(),{get:We}=ke(),F=g(""),A=g("all"),Z=g(!1),ge=g(null),h=g([]),P=g([]),Be=g({pending:0,today:0,thisWeek:0,processingRate:0}),ee=g([]),Ge=g([]),{getWebsiteInfo:He,getWebsiteName:Ue}=Dt(ee),te=g(!1),me=g(!1),oe=g(!1),le=g(!1),se=g(!1),ae=g(!1),ne=g(!1),re=g(null),C=g(null),ie=g(null),O=g(null),V=g(null),E=g(!1),X=g(1),_e=g(5);pe(()=>Math.ceil(Ce.value.length/_e.value));const J=g([]),k=W({}),Xe=[{value:"wp_form",label:"網站表單"},{value:"lineoa",label:"官方賴"},{value:"email",label:"Email"},{value:"phone",label:"電話"}],Ve=[{value:"pending",label:"待處理",category:"leads",route:"/cases"},{value:"valid_customer",label:"有效客",category:"leads_management",route:"/cases/valid-customer"},{value:"invalid_customer",label:"無效客",category:"leads_management",route:"/cases/invalid-customer"},{value:"customer_service",label:"客服",category:"leads_management",route:"/cases/customer-service"},{value:"blacklist",label:"黑名單",category:"leads_management",route:"/cases/blacklist"},{value:"approved_disbursed",label:"核准撥款",category:"submissions",route:"/submissions/approved-disbursed"},{value:"approved_undisbursed",label:"核准未撥",category:"submissions",route:"/submissions/approved-pending"},{value:"conditional_approval",label:"附條件",category:"submissions",route:"/submissions/conditional"},{value:"rejected",label:"婉拒",category:"submissions",route:"/submissions/declined"},{value:"tracking",label:"追蹤中",category:"sales_tracking",route:"/cases/tracking/index.vue"}],Je=Array.from({length:10},(s,e)=>`G${e+1}`),a=W({page_url:"",website_domain:"",channel:"wp_form",case_status:"pending",created_at:"",assigned_to:null,customer_name:"",email:null,mobile_phone:"",line_id:"",line_user_info:{},loan_purpose:"",ip_address:null,notes:"",birth_date:"",id_number:"",education:"",region:"",registered_address:"",home_phone:"",address_same:!1,mailing_address:"",mobile_phone:"",residence_duration:"",residence_owner:"",telecom_provider:"",case_number:"",required_amount:null,company_email:"",company_name:"",company_phone:"",company_address:"",job_title:"",monthly_income:null,new_labor_insurance:!1,employment_duration:"",contact1_name:"",contact1_relationship:"",contact1_phone:"",contact1_available_time:"",contact1_confidential:!1,contact2_name:"",contact2_relationship:"",contact2_phone:"",contact2_confidential:!1,contact2_available_time:"",referrer:""}),q=W({loan_amount:null,loan_type:"",notes:""}),M=W({assigned_to:null}),j=W({display_name:""}),y=W({case_status:"pending",created_at:"",assigned_to:"",source_channel:"",customer_name:"",line_name:"",line_id:"",consultation_items:"",website_domain:"",email:"",phone:""}),Ke=pe(()=>Me),Ce=pe(()=>{let s=h.value;if(F.value&&F.value.length>=2){const e=F.value.toLowerCase();s=s.filter(u=>u.email?.toLowerCase().includes(e)||u.line_id?.toLowerCase().includes(e)||u.payload?.頁面_URL?.toLowerCase().includes(e)||u.source?.toLowerCase().includes(e)||u.assignee?.name?.toLowerCase().includes(e))}return A.value&&A.value!=="all"&&(A.value==="null"?s=s.filter(e=>!e.assigned_to):s=s.filter(e=>e.assigned_to===parseInt(A.value))),s}),de=pe(()=>J.value.filter(s=>s.is_visible)),D=async()=>{Z.value=!0,ge.value=null;try{if(ve().public.apiBaseUrl==="/mock-api"){console.log("loadLeads: Running in mock mode.");const t=he(),n=t.leads.filter($=>($.case_status||$.status||"pending")==="pending");h.value=n,console.log("loadLeads: All leads in store:",t.leads.length),console.log("loadLeads: Filtered pending leads:",n.length),console.log("loadLeads: Filtered leads from mock store:",n),Z.value=!1,console.log("loadLeads: Refreshing badges..."),await H();return}const{items:e,meta:u,success:d}=await Te({case_status:"pending",per_page:1e3});if(d){h.value=e||[];const t=h.value.length,n=new Date,$=h.value.filter(I=>new Date(I.created_at).toDateString()===n.toDateString()).length,R=h.value.filter(I=>{const z=new Date(I.created_at),K=new Date(n);return K.setDate(n.getDate()-n.getDay()),z>=K}).length;Be.value={pending:t,today:$,thisWeek:R,processingRate:t>0?Math.round(R/t*100):0}}}catch(s){ge.value="載入進線數據失敗",console.error("Load leads error:",s)}finally{Z.value=!1}},Qe=async()=>{try{const{success:s,users:e}=await Re({per_page:250});s&&Array.isArray(e)&&(P.value=e)}catch(s){console.warn("Load users failed:",s)}},Le=async()=>{const{success:s,items:e}=await ze("case");s&&(J.value=e)},Ye=async()=>{try{const{data:s,error:e}=await We("/websites/options");!e&&Array.isArray(s)?(ee.value=s,Ge.value=s.map(u=>({value:u.domain,label:u.name,website:u}))):console.warn("Failed to load websites from management system:",e)}catch(s){console.warn("Load websites failed:",s)}},Ze=s=>{F.value=s,X.value=1},et=s=>{X.value=s},tt=s=>{_e.value=s,X.value=1};let xe;kt([F,A],()=>{clearTimeout(xe),xe=setTimeout(()=>{X.value=1},300)});const ot=s=>{C.value=s,me.value=!0},Ie=()=>{me.value=!1,C.value=null},lt=async s=>{re.value=s.id;const e=s.payload?.頁面_URL||s.source||"",u=He(e),d=s.payload||{};Object.assign(a,{page_url:e,website_domain:u.website?u.domain:e?"other":"",channel:s.channel||"wp_form",case_status:s.status||"pending",created_at:s.created_at?new Date(s.created_at).toISOString().slice(0,16):new Date().toISOString().slice(0,16),assigned_to:s.assigned_to||null,customer_name:s.customer_name||"",email:s.email||null,mobile_phone:s.mobile_phone||s.phone||"",line_id:s.line_id||"",line_user_info:s.line_user_info||{},loan_purpose:s.loan_purpose||"",ip_address:s.ip_address||null,notes:s.notes||d.備註||"",birth_date:d.出生年月日||"",id_number:d.身份證字號||"",education:d.最高學歷||"",region:d.房屋區域||d.所在地區||"",registered_address:d.戶籍地址||"",home_phone:d.室內電話||"",address_same:d.通訊地址是否同戶籍地||!1,mailing_address:d.通訊地址||d.房屋地址||"",mobile_phone:d.通訊電話||s.phone||"",residence_duration:d.現居地住多久||"",residence_owner:d.居住地持有人||"",telecom_provider:d.電信業者||"",case_number:ue(s),required_amount:d.資金需求||null,company_email:d.電子郵件||s.email||"",company_name:d.公司名稱||"",company_phone:d.公司電話||"",company_address:d.公司地址||"",job_title:d.職稱||"",monthly_income:d.月收入||null,new_labor_insurance:d.有無新轉勞保||!1,employment_duration:d.目前公司在職多久||"",contact1_name:d["聯絡人①姓名"]||"",contact1_relationship:d["聯絡人①關係"]||"",contact1_phone:d["聯絡人①電話"]||"",contact1_available_time:d.方便聯絡時間||"",contact1_confidential:d.是否保密||!1,contact2_name:d["聯絡人②姓名"]||"",contact2_relationship:d["聯絡人②關係"]||"",contact2_phone:d["聯絡人②電話"]||"",contact2_confidential:d["聯絡人②是否保密"]||!1,contact2_available_time:d["聯絡人②方便聯絡時間"]||"",referrer:d.介紹人||""}),await Le(),mt(s),te.value=!0},fe=()=>{te.value=!1,re.value=null},st=async()=>{if(re.value){E.value=!0;try{let s=a.page_url;if(a.website_domain&&a.website_domain!=="other"){const d=ee.value.find(t=>t.domain===a.website_domain);d&&(s=d.url)}const e={channel:a.channel,status:a.case_status,email:a.email,mobile_phone:a.mobile_phone,line_id:a.line_id,line_user_info:a.line_user_info,loan_purpose:a.loan_purpose,ip_address:a.ip_address,assigned_to:a.assigned_to,notes:a.notes,customer_name:a.customer_name,payload:{頁面_URL:s,LINE_ID:a.line_id,貸款需求:a.loan_purpose,備註:a.notes,出生年月日:a.birth_date,身份證字號:a.id_number,最高學歷:a.education,房屋區域:a.region,戶籍地址:a.registered_address,室內電話:a.home_phone,通訊地址是否同戶籍地:a.address_same,通訊地址:a.mailing_address,通訊電話:a.mobile_phone,現居地住多久:a.residence_duration,居住地持有人:a.residence_owner,電信業者:a.telecom_provider,資金需求:a.required_amount,電子郵件:a.company_email,公司名稱:a.company_name,公司電話:a.company_phone,公司地址:a.company_address,職稱:a.job_title,月收入:a.monthly_income,有無新轉勞保:a.new_labor_insurance,目前公司在職多久:a.employment_duration,"聯絡人①姓名":a.contact1_name,"聯絡人①關係":a.contact1_relationship,"聯絡人①電話":a.contact1_phone,方便聯絡時間:a.contact1_available_time,是否保密:a.contact1_confidential,"聯絡人②姓名":a.contact2_name,"聯絡人②關係":a.contact2_relationship,"聯絡人②電話":a.contact2_phone,"聯絡人②是否保密":a.contact2_confidential,"聯絡人②方便聯絡時間":a.contact2_available_time,介紹人:a.referrer,...k}},{error:u}=await we(re.value,e);u?_(u?.message||"更新失敗"):(te.value=!1,await D(),L("進線資料更新成功"))}catch(s){_("系統錯誤，請稍後再試"),console.error("Update case error:",s)}finally{E.value=!1}}},at=async s=>{if(await be(`確定刪除編號 ${s.id} 的進線嗎？`))try{const{error:u}=await Fe(s.id);u?_(u?.message||"刪除失敗"):(await D(),L(`編號 ${s.id} 的進線已刪除`))}catch(u){_("系統錯誤，請稍後再試"),console.error("Delete lead error:",u)}},nt=s=>{if(!s.customer_id){_("此進線尚未綁定客戶，請先建立/綁定客戶後再送件");return}ie.value=s,Object.assign(q,{loan_amount:null,loan_type:"",notes:""}),oe.value=!0},Se=()=>{oe.value=!1,ie.value=null},rt=async()=>{if(ie.value)try{const{error:s}=await Pe(ie.value.id,q);s?_(s?.message||"轉換失敗"):(oe.value=!1,await D(),L("進線轉換案件成功"))}catch(s){_("系統錯誤，請稍後再試"),console.error("Convert lead error:",s)}},it=s=>{O.value=s,M.assigned_to=s.assigned_to||null,le.value=!0},Ne=()=>{le.value=!1,O.value=null,M.assigned_to=null},dt=async()=>{if(!O.value||!M.assigned_to){_("請選擇承辦業務");return}E.value=!0;try{const{error:s}=await we(O.value.id,{assigned_to:M.assigned_to});if(s)_(s?.message||"指派失敗");else{le.value=!1,await D();const e=P.value.find(u=>u.id===M.assigned_to);L(`已成功指派給 ${e?.name||"未知業務"}`)}}catch(s){_("系統錯誤，請稍後再試"),console.error("Assign lead error:",s)}},ut=s=>{V.value=s,j.display_name=s.line_user_info?.display_name||"",se.value=!0},Ee=()=>{se.value=!1,V.value=null,j.display_name=""},ct=async()=>{if(!V.value||!j.display_name?.trim()){_("名稱不能為空");return}E.value=!0;try{const{$api:s}=It(),{data:e,error:u}=await s.put(`/leads/${V.value.id}/line-name`,{editable_name:j.display_name.trim()});!u&&e?.success?(V.value.line_user_info&&(V.value.line_user_info.display_name=j.display_name.trim(),V.value.line_user_info.editable_name=j.display_name.trim()),se.value=!1,await D(),L(`LINE用戶名稱已更新：${e.old_name} → ${e.new_name}`)):_(e?.message||u?.message||"更新失敗")}catch(s){_("更新失敗，請稍後再試"),console.error("Save LINE name error:",s)}},pt=()=>{Object.assign(y,{case_status:"pending",created_at:new Date().toISOString().slice(0,16),assigned_to:"",source_channel:"",customer_name:"",line_name:"",line_id:"",consultation_items:"",website_domain:"",email:"",phone:""}),ae.value=!0},De=()=>{ae.value=!1},yt=async()=>{if(!y.customer_name?.trim()){_("客戶姓名為必填項目");return}if(!y.source_channel){_("來源管道為必填項目");return}ne.value=!0;try{if(ve().public.apiBaseUrl==="/mock-api"){const e=he(),u={customer_name:y.customer_name.trim(),email:y.email||null,phone:y.phone||null,line_id:y.line_id||null,line_name:y.line_name||null,source_channel:y.source_channel,consultation_items:y.consultation_items||null,website_domain:y.website_domain||null,assigned_to:y.assigned_to||null,case_status:"pending",created_at:new Date().toISOString()},d=e.addLead(u);console.log("New lead added to store:",d),await H(),await D(),ae.value=!1,L(`新增進線 #${d.id} 成功！`);return}}catch(s){console.error("Save add modal error:",s),_("新增失敗，請稍後再試")}finally{ne.value=!1}},je=s=>{const e=Ve.find(u=>u.value===s);return e?e.route:"/"},bt=async(s,e)=>{try{if(ve().public.apiBaseUrl==="/mock-api"){console.log("Using mock mode for updateLeadStatus",{itemId:s.id,newStatus:e});const z=he().updateLeadCaseStatus(s.id,e);if(console.log("Mock update result:",z),z){await D();const K=ye.find(ce=>ce.value===e)?.label;if(L(`進線狀態已更新為：${K}`),await H(),e!=="pending"){const ce=je(e);ce&&setTimeout(async()=>{await be(`進線已移至「${K}」區塊，是否前往查看？`,"前往查看","留在此頁")&&await qe(ce)},1500)}return}else{console.error("Item not found in mock store:",s.id),_("更新失敗：找不到對應的案件");return}}const{patch:d}=ke(),{data:t,error:n}=await d(`/leads/${s.id}/case-status`,{case_status:e});if(n){_("更新進線狀態失敗");return}const $=h.value.findIndex(I=>I.id===s.id);$!==-1&&h.value.splice($,1);const R=ye.find(I=>I.value===e)?.label;if(L(`進線狀態已更新為：${R}`),await H(),e!=="pending"){const I=je(e);I&&setTimeout(async()=>{await be(`進線已移至「${R}」區塊，是否前往查看？`,"前往查看","留在此頁")&&await qe(I)},1500)}}catch(u){_("更新狀態失敗，請稍後再試"),console.error("Update lead status error:",u)}},gt=async(s,e)=>{try{const{patch:u}=ke(),{error:d}=await u(`/leads/${s.id}`,{payload:{...s.payload,頁面_URL:e}});if(d){_("更新網站失敗");return}s.payload.頁面_URL=e,L(`網站已更新為：${e}`)}catch(u){_("更新網站失敗，請稍後再試"),console.error("Update website error:",u)}},mt=s=>{const e=s?.payload||{};J.value.forEach(u=>{const d=u.key;e&&Object.prototype.hasOwnProperty.call(e,d)?k[d]=e[d]:u.default_value?k[d]=u.default_value:k[d]=u.type==="multiselect"?[]:u.type==="boolean"?!1:""})},ue=s=>{const e=new Date(s.created_at),u=e.getFullYear().toString().slice(-2),d=String(e.getMonth()+1).padStart(2,"0"),t=String(e.getDate()).padStart(2,"0"),n=String(s.id).padStart(3,"0");return`CASE${u}${d}${t}${n}`},$e=s=>new Date(s).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit"}),Ae=s=>new Date(s).toLocaleTimeString("zh-TW",{hour:"2-digit",minute:"2-digit"}),_t=(s,e)=>e.type==="multiselect"?Array.isArray(s)?s.join(", "):s||"-":e.type==="boolean"?s?"是":"否":s??"-";wt(async()=>{await Ye(),await Promise.all([Qe(),D(),Le(),H()])}),Ut(()=>{clearTimeout(xe)}),Vt({title:"網路進線"});const xt=async(s,e)=>{try{const u=h.value.findIndex(d=>d.id===s);u!==-1&&(h.value[u].channel=e,L("來源管道更新成功"))}catch(u){console.error("更新來源管道失敗:",u),_("更新來源管道失敗")}},ft=async(s,e)=>{try{const u=h.value.findIndex(d=>d.id===s);u!==-1&&(h.value[u].payload||(h.value[u].payload={}),h.value[u].payload.貸款需求=e,L("諮詢項目更新成功"))}catch(u){console.error("更新諮詢項目失敗:",u),_("更新諮詢項目失敗")}};return(s,e)=>{const u=vt,d=Ct("XMarkIcon");return i(),r("div",zt,[o("div",Wt,[e[32]||(e[32]=o("div",null,[o("h1",{class:"text-3xl font-bold text-gray-900"},"網路進線"),o("p",{class:"text-gray-600 mt-2"},"顯示來自 WP 表單的進件（可搜尋、編輯、刪除）")],-1)),o("button",{onClick:pt,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},[T(l(Tt),{class:"-ml-1 mr-2 h-5 w-5","aria-hidden":"true"}),e[31]||(e[31]=w(" 新增進線 ",-1))])]),T(St,{title:"網路進線列表",columns:l(Ke),data:l(Ce),loading:l(Z),error:l(ge),"search-query":l(F),"search-placeholder":"搜尋姓名/手機/Email/LINE/網站... (至少2個字符)","show-search-icon":!1,"current-page":l(X),"items-per-page":l(_e),"loading-text":"載入中...","empty-text":"沒有網路進線案件",onSearch:Ze,onRefresh:D,onRetry:D,onPageChange:et,onPageSizeChange:tt},{filters:v(()=>[l(Y).hasPermission&&l(Y).hasPermission("customer_management")?p((i(),r("select",{key:0,"onUpdate:modelValue":e[0]||(e[0]=t=>Lt(A)?A.value=t:null),class:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500"},[e[33]||(e[33]=o("option",{value:"all"},"全部承辦",-1)),e[34]||(e[34]=o("option",{value:"null"},"未指派",-1)),(i(!0),r(x,null,f(l(P),t=>(i(),r("option",{key:t.id,value:t.id},c(t.name),9,Bt))),128))],512)),[[U,l(A)]]):b("",!0)]),actions:v(()=>[...e[35]||(e[35]=[])]),"cell-case_status":v(({item:t})=>[o("select",{value:t.case_status||"pending",onChange:n=>bt(t,n.target.value),class:"w-full px-1 py-0.5 text-xs border border-gray-300 rounded bg-white text-gray-900 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"},[(i(),r(x,null,f(Ve,n=>o("option",{key:n.value,value:n.value},c(n.label),9,Ht)),64))],40,Gt)]),"cell-case_number":v(({item:t})=>[o("div",Xt,c(ue(t)),1)]),"cell-website":v(({item:t})=>[o("select",{value:l(Ue)(t),onChange:n=>gt(t,n.target.value),class:"w-full px-1 py-0.5 text-xs border border-gray-300 rounded bg-white text-gray-900 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"},[(i(!0),r(x,null,f(l(Je),n=>(i(),r("option",{key:n,value:n},c(n),9,Kt))),128))],40,Jt)]),"cell-channel":v(({item:t})=>[o("select",{value:t.channel,onChange:n=>xt(t.id,n.target.value),class:"w-full px-2 py-1 text-sm border border-gray-300 rounded bg-white text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[...e[36]||(e[36]=[o("option",{value:"wp_form"},"網站表單",-1),o("option",{value:"lineoa"},"官方LINE",-1),o("option",{value:"email"},"email",-1),o("option",{value:"phone"},"專線",-1)])],40,Qt)]),"cell-datetime":v(({item:t})=>[o("div",null,[o("div",Yt,c($e(t.created_at)),1),o("div",Zt,c(Ae(t.created_at)),1)])]),"cell-assignee":v(({item:t})=>[o("div",eo,[o("span",to,c(t.assignee?.name||"未指派"),1),!t.assignee&&l(Y).hasPermission&&l(Y).hasPermission("customer_management")?(i(),r("button",{key:0,onClick:n=>it(t),class:"inline-flex items-center justify-center w-6 h-6 text-blue-600 hover:text-white hover:bg-blue-600 rounded transition-colors duration-200 relative group",title:"指派業務"},[T(u,{name:"heroicons:user-plus",class:"w-4 h-4"}),e[37]||(e[37]=o("span",{class:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 text-xs text-white bg-gray-800 rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap"}," 指派業務 ",-1))],8,oo)):b("",!0)])]),"cell-contact_info":v(({item:t})=>[o("div",null,[o("div",lo,c(t.email||"未提供"),1),o("div",so,c(t.phone||"未提供"),1)])]),"cell-line_info":v(({item:t})=>[t.line_user_info&&t.is_line_user_id?(i(),r("div",ao,[t.line_user_info.picture_url?(i(),r("img",{key:0,src:t.line_user_info.picture_url,alt:t.line_user_info.display_name||"LINE用戶",class:"w-6 h-6 rounded-full object-cover",onError:e[1]||(e[1]=n=>n.target.style.display="none")},null,40,no)):(i(),r("div",ro," L ")),o("div",io,[o("div",uo,[o("span",co,c(t.line_user_info.display_name||"未設定名稱"),1),o("button",{onClick:n=>ut(t),class:"text-blue-500 hover:text-blue-700 text-xs",title:"編輯LINE名稱"}," ✏️ ",8,po)])])])):t.line_id&&!t.is_line_user_id?(i(),r("div",yo,[e[38]||(e[38]=o("div",{class:"w-6 h-6 rounded-full bg-gray-400 flex items-center justify-center text-white text-xs"}," @ ",-1)),o("span",bo,c(t.line_id),1)])):(i(),r("div",go," 未綁定 "))]),"cell-location":v(({item:t})=>[o("div",null,[o("div",mo,c(t.payload?.房屋區域||t.payload?.所在地區||"未提供"),1),o("div",_o,c(t.payload?.房屋地址||""),1)])]),"cell-amount":v(({item:t})=>[o("span",xo,c(t.payload?.資金需求||"未填寫"),1)]),"cell-purpose":v(({item:t})=>[o("select",{value:t.payload?.貸款需求||"",onChange:n=>ft(t.id,n.target.value),class:"w-full px-2 py-1 text-sm border border-gray-300 rounded bg-white text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[...e[39]||(e[39]=[o("option",{value:""},"請選擇",-1),o("option",{value:"房屋貸款"},"房屋貸款",-1),o("option",{value:"土地貸款"},"土地貸款",-1),o("option",{value:"企業貸款"},"企業貸款",-1),o("option",{value:"個人信貸"},"個人信貸",-1),o("option",{value:"汽車貸款"},"汽車貸款",-1),o("option",{value:"其他"},"其他",-1)])],40,fo)]),"cell-custom_fields":v(({item:t})=>[l(de).length>0?(i(),r("div",vo,[(i(!0),r(x,null,f(l(de).slice(0,2),n=>(i(),r("div",{key:n.id,class:"text-xs"},[o("span",ho,c(n.label)+":",1),o("span",ko,c(_t(t.payload?.[n.key],n)),1)]))),128)),l(de).length>2?(i(),r("div",wo," +"+c(l(de).length-2)+" 個欄位 ",1)):b("",!0)])):(i(),r("span",Uo,"無自定義欄位"))]),"cell-actions":v(({item:t})=>[o("div",Vo,[o("button",{onClick:n=>ot(t),class:"group relative inline-flex items-center justify-center p-2 text-blue-600 hover:text-white hover:bg-blue-600 rounded-lg transition-all duration-200",title:"查看詳情"},[T(l(Ft),{class:"w-4 h-4"}),e[40]||(e[40]=o("div",{class:"absolute bottom-full mb-2 hidden group-hover:block px-2 py-1 text-xs text-white bg-gray-900 rounded whitespace-nowrap z-10"}," 查看詳情 ",-1))],8,Co),o("button",{onClick:n=>lt(t),class:"group relative inline-flex items-center justify-center p-2 text-gray-600 hover:text-white hover:bg-gray-600 rounded-lg transition-all duration-200",title:"編輯"},[T(l(Nt),{class:"w-4 h-4"}),e[41]||(e[41]=o("div",{class:"absolute bottom-full mb-2 hidden group-hover:block px-2 py-1 text-xs text-white bg-gray-900 rounded whitespace-nowrap z-10"}," 編輯 ",-1))],8,Lo),t.customer_id?(i(),r("button",{key:0,onClick:n=>nt(t),class:"group relative inline-flex items-center justify-center p-2 text-purple-600 hover:text-white hover:bg-purple-600 rounded-lg transition-all duration-200",title:"轉送件"},[T(l(Pt),{class:"w-4 h-4"}),e[42]||(e[42]=o("div",{class:"absolute bottom-full mb-2 hidden group-hover:block px-2 py-1 text-xs text-white bg-gray-900 rounded whitespace-nowrap z-10"}," 轉送件 ",-1))],8,Io)):b("",!0),o("button",{onClick:n=>at(t),class:"group relative inline-flex items-center justify-center p-2 text-red-600 hover:text-white hover:bg-red-600 rounded-lg transition-all duration-200",title:"刪除"},[T(l(Rt),{class:"w-4 h-4"}),e[43]||(e[43]=o("div",{class:"absolute bottom-full mb-2 hidden group-hover:block px-2 py-1 text-xs text-white bg-gray-900 rounded whitespace-nowrap z-10"}," 刪除 ",-1))],8,So)])]),_:1},8,["columns","data","loading","error","search-query","current-page","items-per-page"]),l(ae)?(i(),r("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 mt-0",onClick:S(De,["self"])},[o("div",No,[e[60]||(e[60]=o("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"新增進線",-1)),o("form",{onSubmit:S(yt,["prevent"]),class:"grid grid-cols-1 md:grid-cols-2 gap-4"},[o("div",null,[e[45]||(e[45]=o("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"案件狀態",-1)),p(o("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>l(y).case_status=t),class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-500",disabled:""},[...e[44]||(e[44]=[o("option",{value:"pending"},"待處理",-1)])],512),[[U,l(y).case_status]])]),o("div",null,[e[46]||(e[46]=o("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"時間",-1)),p(o("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>l(y).created_at=t),type:"datetime-local",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-500",readonly:""},null,512),[[m,l(y).created_at]])]),o("div",null,[e[48]||(e[48]=o("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"承辦業務",-1)),p(o("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>l(y).assigned_to=t),class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[e[47]||(e[47]=o("option",{value:""},"未指派",-1)),(i(!0),r(x,null,f(l(P),t=>(i(),r("option",{key:t.id,value:t.id},c(t.name),9,Eo))),128))],512),[[U,l(y).assigned_to]])]),o("div",null,[e[50]||(e[50]=o("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},[w("來源管道 "),o("span",{class:"text-red-500"},"*")],-1)),p(o("select",{"onUpdate:modelValue":e[5]||(e[5]=t=>l(y).source_channel=t),class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:""},[...e[49]||(e[49]=[Oe('<option value="" data-v-c53a3ffa>請選擇來源管道</option><option value="website" data-v-c53a3ffa>官網</option><option value="line" data-v-c53a3ffa>LINE</option><option value="facebook" data-v-c53a3ffa>Facebook</option><option value="google" data-v-c53a3ffa>Google廣告</option><option value="referral" data-v-c53a3ffa>轉介紹</option><option value="other" data-v-c53a3ffa>其他</option>',7)])],512),[[U,l(y).source_channel]])]),o("div",null,[e[51]||(e[51]=o("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},[w("姓名 "),o("span",{class:"text-red-500"},"*")],-1)),p(o("input",{"onUpdate:modelValue":e[6]||(e[6]=t=>l(y).customer_name=t),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:""},null,512),[[m,l(y).customer_name]])]),o("div",null,[e[52]||(e[52]=o("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"LINE顯示名稱",-1)),p(o("input",{"onUpdate:modelValue":e[7]||(e[7]=t=>l(y).line_name=t),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[m,l(y).line_name]])]),o("div",null,[e[53]||(e[53]=o("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"LINE ID",-1)),p(o("input",{"onUpdate:modelValue":e[8]||(e[8]=t=>l(y).line_id=t),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[m,l(y).line_id]])]),o("div",Do,[e[54]||(e[54]=o("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"諮詢項目",-1)),p(o("textarea",{"onUpdate:modelValue":e[9]||(e[9]=t=>l(y).consultation_items=t),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"請描述客戶的諮詢需求..."},null,512),[[m,l(y).consultation_items]])]),o("div",null,[e[56]||(e[56]=o("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"網站",-1)),p(o("select",{"onUpdate:modelValue":e[10]||(e[10]=t=>l(y).website_domain=t),class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[e[55]||(e[55]=o("option",{value:""},"請選擇網站",-1)),(i(!0),r(x,null,f(l(ee),t=>(i(),r("option",{key:t.id,value:t.domain},c(t.name),9,jo))),128))],512),[[U,l(y).website_domain]])]),e[59]||(e[59]=o("div",null,null,-1)),o("div",null,[e[57]||(e[57]=o("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"電子郵件",-1)),p(o("input",{"onUpdate:modelValue":e[11]||(e[11]=t=>l(y).email=t),type:"email",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[m,l(y).email]])]),o("div",null,[e[58]||(e[58]=o("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"手機",-1)),p(o("input",{"onUpdate:modelValue":e[12]||(e[12]=t=>l(y).phone=t),type:"tel",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[m,l(y).phone]])]),o("div",$o,[o("button",{type:"button",class:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",onClick:De},"取消"),o("button",{type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",disabled:l(ne)},c(l(ne)?"新增中...":"新增"),9,Ao)])],32)])])):b("",!0),l(te)?(i(),r("div",{key:1,class:"fixed inset-0 bg-black/50 z-50",onClick:S(fe,["self"])},[o("div",Oo,[o("div",qo,[e[61]||(e[61]=o("h3",{class:"text-xl font-semibold text-gray-900"},"編輯進線",-1)),o("button",{type:"button",onClick:fe,class:"text-gray-500 hover:text-gray-700"},[T(d,{class:"w-6 h-6"})])]),o("div",Mo,[o("form",{onSubmit:S(st,["prevent"]),class:"h-full flex"},[o("div",To,[e[73]||(e[73]=o("h4",{class:"text-lg font-semibold text-gray-800 mb-4 sticky top-0 bg-gray-50 py-2"},"基本資訊",-1)),o("div",Fo,[o("div",null,[e[62]||(e[62]=o("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"進線狀態",-1)),p(o("select",{"onUpdate:modelValue":e[13]||(e[13]=t=>l(a).case_status=t),class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[(i(),r(x,null,f(ye,t=>o("option",{key:t.value,value:t.value},c(t.label),9,Po)),64))],512),[[U,l(a).case_status]])]),o("div",null,[e[63]||(e[63]=o("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"時間",-1)),p(o("input",{"onUpdate:modelValue":e[14]||(e[14]=t=>l(a).created_at=t),type:"datetime-local",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",readonly:""},null,512),[[m,l(a).created_at]])]),o("div",null,[e[65]||(e[65]=o("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"承辦業務",-1)),p(o("select",{"onUpdate:modelValue":e[15]||(e[15]=t=>l(a).assigned_to=t),class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[e[64]||(e[64]=o("option",{value:""},"未指派",-1)),(i(!0),r(x,null,f(l(P),t=>(i(),r("option",{key:t.id,value:t.id},c(t.name),9,Ro))),128))],512),[[U,l(a).assigned_to]])]),o("div",null,[e[66]||(e[66]=o("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"來源管道",-1)),p(o("select",{"onUpdate:modelValue":e[16]||(e[16]=t=>l(a).channel=t),class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[(i(),r(x,null,f(Xe,t=>o("option",{key:t.value,value:t.value},c(t.label),9,zo)),64))],512),[[U,l(a).channel]])]),o("div",null,[e[67]||(e[67]=o("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"姓名",-1)),p(o("input",{"onUpdate:modelValue":e[17]||(e[17]=t=>l(a).customer_name=t),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-gray-500 focus:border-gray-500"},null,512),[[m,l(a).customer_name]])]),o("div",null,[e[68]||(e[68]=o("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"LINE資訊",-1)),o("div",Wo,[p(o("input",{"onUpdate:modelValue":e[18]||(e[18]=t=>l(a).line_user_info.display_name=t),placeholder:"LINE顯示名稱",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-gray-500 focus:border-gray-500"},null,512),[[m,l(a).line_user_info.display_name]]),p(o("input",{"onUpdate:modelValue":e[19]||(e[19]=t=>l(a).line_id=t),placeholder:"LINE加好友ID",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-gray-500 focus:border-gray-500"},null,512),[[m,l(a).line_id]])])]),o("div",null,[e[70]||(e[70]=o("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"諮詢項目",-1)),p(o("select",{"onUpdate:modelValue":e[20]||(e[20]=t=>l(a).loan_purpose=t),class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-gray-500 focus:border-gray-500"},[...e[69]||(e[69]=[Oe('<option value="" data-v-c53a3ffa>請選擇諮詢項目</option><option value="房屋貸款" data-v-c53a3ffa>房屋貸款</option><option value="信用貸款" data-v-c53a3ffa>信用貸款</option><option value="汽車貸款" data-v-c53a3ffa>汽車貸款</option><option value="企業貸款" data-v-c53a3ffa>企業貸款</option><option value="債務整合" data-v-c53a3ffa>債務整合</option><option value="投資理財" data-v-c53a3ffa>投資理財</option><option value="其他" data-v-c53a3ffa>其他</option>',8)])],512),[[U,l(a).loan_purpose]])]),o("div",null,[e[71]||(e[71]=o("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"網站",-1)),p(o("select",{"onUpdate:modelValue":e[21]||(e[21]=t=>l(a).website=t),class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[(i(),r(x,null,f(10,t=>o("option",{key:t,value:`G${t}`},"G"+c(t),9,Bo)),64))],512),[[U,l(a).website]])]),o("div",null,[e[72]||(e[72]=o("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"聯絡資訊",-1)),o("div",Go,[p(o("input",{"onUpdate:modelValue":e[22]||(e[22]=t=>l(a).email=t),type:"email",placeholder:"Email",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-gray-500 focus:border-gray-500"},null,512),[[m,l(a).email]]),p(o("input",{"onUpdate:modelValue":e[23]||(e[23]=t=>l(a).mobile_phone=t),type:"tel",placeholder:"手機號碼",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-gray-500 focus:border-gray-500"},null,512),[[m,l(a).mobile_phone]])])])])]),o("div",Ho,[o("h4",Xo,c(N.personal.title),1),o("div",Jo,[(i(!0),r(x,null,f(N.personal.fields,t=>(i(),r("div",{key:t.key},[o("label",Ko,[w(c(t.label)+" ",1),t.required?(i(),r("span",Qo,"*")):b("",!0)]),t.type==="text"||t.type==="email"?p((i(),r("input",{key:0,"onUpdate:modelValue":n=>l(a)[t.key]=n,type:t.type,readonly:t.readonly,class:Q(["w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"bg-gray-100":t.readonly}])},null,10,Yo)),[[B,l(a)[t.key]]]):t.type==="number"?p((i(),r("input",{key:1,"onUpdate:modelValue":n=>l(a)[t.key]=n,type:"number",min:"0",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,Zo)),[[m,l(a)[t.key],void 0,{number:!0}]]):t.type==="date"?p((i(),r("input",{key:2,"onUpdate:modelValue":n=>l(a)[t.key]=n,type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,el)),[[m,l(a)[t.key]]]):t.type==="select"?p((i(),r("select",{key:3,"onUpdate:modelValue":n=>l(a)[t.key]=n,class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[e[74]||(e[74]=o("option",{value:""},"請選擇",-1)),(i(!0),r(x,null,f(t.options,n=>(i(),r("option",{key:n,value:n},c(n),9,ol))),128))],8,tl)),[[U,l(a)[t.key]]]):t.type==="boolean"?(i(),r("label",ll,[p(o("input",{type:"checkbox","onUpdate:modelValue":n=>l(a)[t.key]=n,class:"rounded"},null,8,sl),[[G,l(a)[t.key]]]),e[75]||(e[75]=o("span",{class:"text-sm"},"是",-1))])):t.type==="custom"?(i(),r("div",al," 自定義欄位將顯示在下方 ")):b("",!0)]))),128))])]),o("div",nl,[o("h4",rl,c(N.contact.title),1),o("div",il,[(i(!0),r(x,null,f(N.contact.fields,t=>(i(),r("div",{key:t.key},[o("label",dl,[w(c(t.label)+" ",1),t.required?(i(),r("span",ul,"*")):b("",!0)]),t.type==="text"||t.type==="email"?p((i(),r("input",{key:0,"onUpdate:modelValue":n=>l(a)[t.key]=n,type:t.type,readonly:t.readonly,class:Q(["w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"bg-gray-100":t.readonly}])},null,10,cl)),[[B,l(a)[t.key]]]):t.type==="number"?p((i(),r("input",{key:1,"onUpdate:modelValue":n=>l(a)[t.key]=n,type:"number",min:"0",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,pl)),[[m,l(a)[t.key],void 0,{number:!0}]]):t.type==="date"?p((i(),r("input",{key:2,"onUpdate:modelValue":n=>l(a)[t.key]=n,type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,yl)),[[m,l(a)[t.key]]]):t.type==="select"?p((i(),r("select",{key:3,"onUpdate:modelValue":n=>l(a)[t.key]=n,class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[e[76]||(e[76]=o("option",{value:""},"請選擇",-1)),(i(!0),r(x,null,f(t.options,n=>(i(),r("option",{key:n,value:n},c(n),9,gl))),128))],8,bl)),[[U,l(a)[t.key]]]):t.type==="boolean"?(i(),r("label",ml,[p(o("input",{type:"checkbox","onUpdate:modelValue":n=>l(a)[t.key]=n,class:"rounded"},null,8,_l),[[G,l(a)[t.key]]]),e[77]||(e[77]=o("span",{class:"text-sm"},"是",-1))])):b("",!0)]))),128))])]),o("div",xl,[o("h4",fl,c(N.company.title),1),o("div",vl,[(i(!0),r(x,null,f(N.company.fields,t=>(i(),r("div",{key:t.key},[o("label",hl,[w(c(t.label)+" ",1),t.required?(i(),r("span",kl,"*")):b("",!0)]),t.type==="text"||t.type==="email"?p((i(),r("input",{key:0,"onUpdate:modelValue":n=>l(a)[t.key]=n,type:t.type,readonly:t.readonly,class:Q(["w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"bg-gray-100":t.readonly}])},null,10,wl)),[[B,l(a)[t.key]]]):t.type==="number"?p((i(),r("input",{key:1,"onUpdate:modelValue":n=>l(a)[t.key]=n,type:"number",min:"0",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,Ul)),[[m,l(a)[t.key],void 0,{number:!0}]]):t.type==="boolean"?(i(),r("label",Vl,[p(o("input",{type:"checkbox","onUpdate:modelValue":n=>l(a)[t.key]=n,class:"rounded"},null,8,Cl),[[G,l(a)[t.key]]]),e[78]||(e[78]=o("span",{class:"text-sm"},"是",-1))])):b("",!0)]))),128))])]),o("div",Ll,[o("h4",Il,c(N.emergency.title),1),o("div",Sl,[(i(!0),r(x,null,f(N.emergency.fields,t=>(i(),r("div",{key:t.key},[o("label",Nl,[w(c(t.label)+" ",1),t.required?(i(),r("span",El,"*")):b("",!0)]),t.type==="text"?p((i(),r("input",{key:0,"onUpdate:modelValue":n=>l(a)[t.key]=n,type:t.type,readonly:t.readonly,class:Q(["w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"bg-gray-100":t.readonly}])},null,10,Dl)),[[B,l(a)[t.key]]]):t.type==="boolean"?(i(),r("label",jl,[p(o("input",{type:"checkbox","onUpdate:modelValue":n=>l(a)[t.key]=n,class:"rounded"},null,8,$l),[[G,l(a)[t.key]]]),e[79]||(e[79]=o("span",{class:"text-sm"},"是",-1))])):b("",!0)]))),128))])]),o("div",Al,[o("h4",Ol,c(N.other.title),1),o("div",ql,[(i(!0),r(x,null,f(N.other.fields.filter(t=>t.type!=="custom"),t=>(i(),r("div",{key:t.key},[o("label",Ml,[w(c(t.label)+" ",1),t.required?(i(),r("span",Tl,"*")):b("",!0)]),t.type==="text"?p((i(),r("input",{key:0,"onUpdate:modelValue":n=>l(a)[t.key]=n,type:t.type,readonly:t.readonly,class:Q(["w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"bg-gray-100":t.readonly}])},null,10,Fl)),[[B,l(a)[t.key]]]):t.type==="number"?p((i(),r("input",{key:1,"onUpdate:modelValue":n=>l(a)[t.key]=n,type:"number",min:"0",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,Pl)),[[m,l(a)[t.key],void 0,{number:!0}]]):b("",!0)]))),128)),l(J).length?(i(),r("div",Rl,[e[82]||(e[82]=o("h5",{class:"text-md font-medium text-gray-800 mb-3"},"自定義欄位",-1)),o("div",zl,[(i(!0),r(x,null,f(l(J),t=>(i(),r("div",{key:t.id},[o("label",Wl,[w(c(t.label)+" ",1),t.is_required?(i(),r("span",Bl,"*")):b("",!0)]),["text","number","decimal","date"].includes(t.type)?p((i(),r("input",{key:0,type:t.type==="decimal"||t.type==="number"?"number":t.type==="date"?"date":"text",step:t.type==="decimal"?"any":void 0,class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:t.is_required,"onUpdate:modelValue":n=>l(k)[t.key]=n},null,8,Gl)),[[B,l(k)[t.key]]]):t.type==="textarea"?p((i(),r("textarea",{key:1,class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:t.is_required,"onUpdate:modelValue":n=>l(k)[t.key]=n,rows:"2"},null,8,Hl)),[[m,l(k)[t.key]]]):t.type==="select"?p((i(),r("select",{key:2,class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:t.is_required,"onUpdate:modelValue":n=>l(k)[t.key]=n},[e[80]||(e[80]=o("option",{value:""},"請選擇",-1)),(i(!0),r(x,null,f(t.options||[],n=>(i(),r("option",{key:n,value:n},c(n),9,Jl))),128))],8,Xl)),[[U,l(k)[t.key]]]):t.type==="multiselect"?(i(),r("div",Kl,[o("div",Ql,[(i(!0),r(x,null,f(t.options||[],n=>(i(),r("label",{key:n,class:"inline-flex items-center text-sm"},[p(o("input",{type:"checkbox",value:n,"onUpdate:modelValue":$=>l(k)[t.key]=$,class:"mr-1"},null,8,Yl),[[G,l(k)[t.key]]]),o("span",null,c(n),1)]))),128))])])):t.type==="boolean"?(i(),r("label",Zl,[p(o("input",{type:"checkbox","onUpdate:modelValue":n=>l(k)[t.key]=n},null,8,es),[[G,l(k)[t.key]]]),e[81]||(e[81]=o("span",{class:"text-sm"},"是/否",-1))])):b("",!0)]))),128))])])):b("",!0),o("div",ts,[e[83]||(e[83]=o("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"備註",-1)),p(o("textarea",{"onUpdate:modelValue":e[24]||(e[24]=t=>l(a).notes=t),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[m,l(a).notes]])]),o("div",os,[o("button",{type:"button",class:"px-4 py-2 border border-gray-300 rounded-lg",onClick:fe},"取消"),o("button",{type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",disabled:l(E)},c(l(E)?"儲存中...":"儲存"),9,ls)])])])],32)])])])):b("",!0),l(me)?(i(),r("div",{key:2,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 mt-0",onClick:S(Ie,["self"])},[o("div",ss,[o("div",{class:"flex justify-between items-center mb-4"},[e[84]||(e[84]=o("h3",{class:"text-lg font-semibold text-gray-900"},"進線詳情",-1)),o("button",{onClick:Ie,class:"text-gray-400 hover:text-gray-600"}," ✕ ")]),l(C)?(i(),r("div",as,[o("div",ns,[o("div",null,[e[85]||(e[85]=o("label",{class:"block text-sm font-medium text-gray-700"},"網站",-1)),o("p",rs,c(l(Ue)(l(C))),1)]),o("div",null,[e[86]||(e[86]=o("label",{class:"block text-sm font-medium text-gray-700"},"來源管道",-1)),o("p",is,c(l(C).channel||"wp_form"),1)]),o("div",null,[e[87]||(e[87]=o("label",{class:"block text-sm font-medium text-gray-700"},"時間",-1)),o("p",ds,c($e(l(C).created_at))+" "+c(Ae(l(C).created_at)),1)]),o("div",null,[e[88]||(e[88]=o("label",{class:"block text-sm font-medium text-gray-700"},"承辦業務",-1)),o("p",us,c(l(C).assignee?.name||"未指派"),1)]),o("div",null,[e[89]||(e[89]=o("label",{class:"block text-sm font-medium text-gray-700"},"Email",-1)),o("p",cs,c(l(C).email||"未提供"),1)]),o("div",null,[e[90]||(e[90]=o("label",{class:"block text-sm font-medium text-gray-700"},"LINE ID",-1)),o("p",ps,c(l(C).line_id||"未提供"),1)])]),l(C).notes?(i(),r("div",ys,[e[91]||(e[91]=o("label",{class:"block text-sm font-medium text-gray-700"},"備註",-1)),o("p",bs,c(l(C).notes),1)])):b("",!0)])):b("",!0)])])):b("",!0),l(oe)?(i(),r("div",{key:3,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 mt-0",onClick:S(Se,["self"])},[o("div",gs,[e[96]||(e[96]=o("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"送件（建立案件）",-1)),o("form",{onSubmit:S(rt,["prevent"]),class:"space-y-3"},[o("div",ms,[o("div",null,[e[92]||(e[92]=o("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"貸款金額",-1)),p(o("input",{"onUpdate:modelValue":e[25]||(e[25]=t=>l(q).loan_amount=t),required:"",type:"number",min:"0",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[m,l(q).loan_amount,void 0,{number:!0}]])]),o("div",null,[e[93]||(e[93]=o("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"貸款類型",-1)),p(o("input",{"onUpdate:modelValue":e[26]||(e[26]=t=>l(q).loan_type=t),class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[m,l(q).loan_type]])]),o("div",_s,[e[94]||(e[94]=o("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"備註",-1)),p(o("textarea",{"onUpdate:modelValue":e[27]||(e[27]=t=>l(q).notes=t),rows:"2",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[m,l(q).notes]])])]),o("div",{class:"flex justify-end space-x-3 pt-2"},[o("button",{type:"button",class:"px-4 py-2 border border-gray-300 rounded-lg",onClick:Se},"取消"),e[95]||(e[95]=o("button",{type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"},"送件",-1))])],32)])])):b("",!0),l(le)?(i(),r("div",{key:4,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 mt-0",onClick:S(Ne,["self"])},[o("div",xs,[e[103]||(e[103]=o("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"指派承辦業務",-1)),o("form",{onSubmit:S(dt,["prevent"]),class:"space-y-4"},[l(O)?(i(),r("div",fs,[e[100]||(e[100]=o("div",{class:"text-sm text-gray-900 font-semibold mb-2"},"進線資訊：",-1)),o("div",vs,[o("div",hs,[e[97]||(e[97]=o("span",{class:"font-medium"},"進線編號：",-1)),w(c(ue(l(O))),1)]),o("div",ks,[e[98]||(e[98]=o("span",{class:"font-medium"},"Email：",-1)),w(c(l(O).email||"未提供"),1)]),o("div",ws,[e[99]||(e[99]=o("span",{class:"font-medium"},"LINE ID：",-1)),w(c(l(O).line_id||"未提供"),1)])])])):b("",!0),o("div",null,[e[102]||(e[102]=o("label",{class:"block text-sm font-semibold text-gray-900 mb-2"},[w("選擇承辦業務 "),o("span",{class:"text-red-500"},"*")],-1)),p(o("select",{"onUpdate:modelValue":e[28]||(e[28]=t=>l(M).assigned_to=t),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[e[101]||(e[101]=o("option",{value:""},"請選擇業務人員",-1)),(i(!0),r(x,null,f(l(P).filter(t=>t.roles?.[0]?.name==="staff"),t=>(i(),r("option",{key:t.id,value:t.id},c(t.name||t.email)+" (業務) ",9,Us))),128))],512),[[U,l(M).assigned_to]])]),o("div",Vs,[o("button",{type:"button",class:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",onClick:Ne}," 取消 "),o("button",{type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",disabled:l(E)||!l(M).assigned_to},c(l(E)?"指派中...":"確認指派"),9,Cs)])],32)])])):b("",!0),l(se)?(i(),r("div",{key:5,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 mt-0",onClick:S(Ee,["self"])},[o("div",Ls,[e[106]||(e[106]=o("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"編輯LINE名稱",-1)),o("form",{onSubmit:S(ct,["prevent"]),class:"space-y-4"},[l(V)?(i(),r("div",Is,[e[104]||(e[104]=o("div",{class:"text-sm text-gray-900 font-semibold mb-2"},"LINE使用者資訊：",-1)),o("div",Ss,[l(V).line_user_info?.picture_url?(i(),r("img",{key:0,src:l(V).line_user_info.picture_url,alt:l(V).line_user_info.display_name||"LINE用戶",class:"w-10 h-10 rounded-full object-cover",onError:e[29]||(e[29]=t=>t.target.style.display="none")},null,40,Ns)):(i(),r("div",Es," L ")),o("div",null,[o("div",Ds,c(l(V).line_user_info?.display_name||"未設定名稱"),1),o("div",js,"進線編號："+c(ue(l(V))),1)])])])):b("",!0),o("div",null,[e[105]||(e[105]=o("label",{class:"block text-sm font-semibold text-gray-900 mb-2"},[w("LINE名稱 "),o("span",{class:"text-red-500"},"*")],-1)),p(o("input",{"onUpdate:modelValue":e[30]||(e[30]=t=>l(j).display_name=t),required:"",maxlength:"100",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"請輸入LINE名稱"},null,512),[[m,l(j).display_name]])]),o("div",$s,[o("button",{type:"button",class:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",onClick:Ee}," 取消 "),o("button",{type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",disabled:l(E)||!l(j).display_name?.trim()},c(l(E)?"儲存中...":"儲存"),9,As)])],32)])])):b("",!0)])}}},la=ht(Os,[["__scopeId","data-v-c53a3ffa"]]);export{la as default};
