import{_ as Be,r as g,b as R,c as a,o as n,a as t,x as C,t as r,F as v,q as w,s as fe,j as A,H as ae,y as Pe,i as Re,C as qe,u as We,e as P,d as l,k as U,f as O,g as d,v as f,I as h,A as xe}from"#entry";import{_ as He,r as Ye}from"./CRGlAI26.js";import{u as Ge}from"./l19cjJOa.js";import{u as Qe}from"./CuXVLCuF.js";import{u as Je}from"./DdqGq6Yh.js";import{u as Ke,a as Xe}from"./DgLT0ASK.js";import{u as Ze}from"./BtlpaPqX.js";import{u as et}from"./7WFD-W98.js";import{u as tt}from"./DzJdZt_Q.js";import{r as st}from"./UqRq4KLf.js";import{r as lt}from"./BKE9UY2T.js";import{r as ot}from"./DdngC8ig.js";import"./B5My0XuL.js";import"./CKtbBPOe.js";import"./CaSEveCJ.js";import"./DQZituR6.js";const at={class:"bg-white shadow overflow-hidden sm:rounded-lg p-6"},nt={class:"flex justify-between items-center mb-4"},rt={class:"flex space-x-2"},it={class:"text-lg font-medium"},ut={class:"grid grid-cols-7 gap-1 text-center font-medium text-gray-700"},dt={class:"grid grid-cols-7 gap-1 border-t border-gray-200 mt-2"},gt={key:0,class:"mt-1 space-y-1 overflow-y-auto max-h-14"},bt=["onClick"],ct={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},yt={class:"bg-white rounded-lg p-6 w-full max-w-md mx-4"},mt={key:0,class:"space-y-2"},pt={__name:"TrackingCalendar",props:{events:{type:Array,default:()=>[]}},setup(ne){const H=ne,N=new Date,c=g(N.getMonth()),_=g(N.getFullYear()),X=["日","一","二","三","四","五","六"],Y=(x,y)=>new Date(x,y+1,0).getDate(),Z=(x,y)=>new Date(x,y,1).getDay(),ee=R(()=>{const x=Y(_.value,c.value),y=Z(_.value,c.value),b=[],D=Y(_.value,c.value-1);for(let p=y-1;p>=0;p--)b.push({date:new Date(_.value,c.value-1,D-p),dayOfMonth:D-p,isCurrentMonth:!1,isToday:!1,events:[]});for(let p=1;p<=x;p++){const I=new Date(_.value,c.value,p),z=I.toDateString()===N.toDateString();b.push({date:I,dayOfMonth:p,isCurrentMonth:!0,isToday:z,events:H.events.filter(F=>{const T=new Date(F.date);return T.getFullYear()===_.value&&T.getMonth()===c.value&&T.getDate()===p})})}const M=42-b.length;for(let p=1;p<=M;p++)b.push({date:new Date(_.value,c.value+1,p),dayOfMonth:p,isCurrentMonth:!1,isToday:!1,events:[]});return b}),te=()=>{c.value===0?(c.value=11,_.value--):c.value--},se=()=>{c.value===11?(c.value=0,_.value++):c.value++},q=g(!1),L=g(null),E=x=>{L.value=x,q.value=!0},S=()=>{q.value=!1,L.value=null},V=x=>new Date(x).toLocaleDateString("zh-TW",{year:"numeric",month:"long",day:"numeric"});return(x,y)=>(n(),a("div",at,[t("div",nt,[y[0]||(y[0]=t("h2",{class:"text-xl font-semibold text-gray-900"},"追蹤行事曆",-1)),t("div",rt,[t("button",{onClick:te,class:"px-3 py-1 bg-gray-200 rounded-md hover:bg-gray-300"}," 上個月 "),t("span",it,r(_.value)+" 年 "+r(c.value+1)+" 月",1),t("button",{onClick:se,class:"px-3 py-1 bg-gray-200 rounded-md hover:bg-gray-300"}," 下個月 ")])]),t("div",ut,[(n(),a(v,null,w(X,b=>t("div",{key:b,class:"py-2"},r(b),1)),64))]),t("div",dt,[(n(!0),a(v,null,w(ee.value,b=>(n(),a("div",{key:b.date,class:fe(["p-2 h-24 relative border-b border-gray-200",{"bg-gray-50 text-gray-400":!b.isCurrentMonth,"bg-white":b.isCurrentMonth,"border-blue-500 border-2":b.isToday}])},[t("div",{class:fe(["text-sm font-medium",{"text-blue-600":b.isToday&&b.isCurrentMonth,"text-gray-900":!b.isToday&&b.isCurrentMonth}])},r(b.dayOfMonth),3),b.events.length>0?(n(),a("div",gt,[(n(!0),a(v,null,w(b.events,D=>(n(),a("div",{key:D.id,class:"bg-blue-100 text-blue-800 text-xs font-medium px-1.5 py-0.5 rounded-md cursor-pointer hover:bg-blue-200",onClick:M=>E(D)},r(D.title),9,bt))),128))])):C("",!0)],2))),128))]),q.value?(n(),a("div",ct,[t("div",yt,[y[5]||(y[5]=t("h3",{class:"text-lg font-semibold mb-4"},"事件詳情",-1)),L.value?(n(),a("div",mt,[t("p",null,[y[1]||(y[1]=t("strong",null,"標題:",-1)),A(" "+r(L.value.title),1)]),t("p",null,[y[2]||(y[2]=t("strong",null,"日期:",-1)),A(" "+r(V(L.value.date)),1)]),t("p",null,[y[3]||(y[3]=t("strong",null,"描述:",-1)),A(" "+r(L.value.description),1)]),t("p",null,[y[4]||(y[4]=t("strong",null,"案件ID:",-1)),A(" "+r(L.value.caseId),1)])])):C("",!0),t("div",{class:"mt-6 flex justify-end"},[t("button",{onClick:S,class:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300"},"關閉")])])])):C("",!0)]))}},ft=Be(pt,[["__scopeId","data-v-3863960a"]]),xt={class:"space-y-6"},vt={class:"flex items-center justify-between"},wt=["value"],_t=["value"],kt=["value","onChange"],ht=["value"],Ct=["value","onChange"],Dt={class:"text-sm font-medium text-gray-900"},Ut={class:"text-sm text-gray-900"},St={class:"text-sm text-gray-900"},Lt={class:"text-sm text-gray-900"},Vt={class:"text-xs text-gray-500"},Mt={class:"flex items-center space-x-2"},At={class:"text-sm text-gray-900"},Et={key:0,class:"flex items-center space-x-2"},Tt=["src","alt"],$t={key:1,class:"w-6 h-6 rounded-full bg-green-500 flex items-center justify-center text-white text-xs"},Nt={class:"flex-1 min-w-0"},jt={class:"flex items-center space-x-1"},Ot={class:"text-xs font-medium text-gray-900 truncate"},It={key:1,class:"flex items-center space-x-2"},zt={class:"text-xs text-gray-900"},Ft={key:2,class:"text-xs text-gray-400"},Bt={key:0,class:"space-y-1"},Pt={class:"text-gray-500"},Rt={class:"text-gray-900 ml-1"},qt={key:0,class:"text-xs text-gray-400"},Wt={key:1,class:"text-xs text-gray-400"},Ht={class:"flex items-center space-x-2 justify-end"},Yt=["onClick"],Gt=["onClick"],Qt=["onClick"],Jt={class:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto"},Kt={key:0,class:"space-y-4"},Xt={class:"grid grid-cols-2 gap-4"},Zt={class:"text-gray-900"},es={class:"text-gray-900"},ts={class:"text-gray-900"},ss={class:"text-gray-900"},ls={class:"text-gray-900"},os={class:"text-gray-900"},as={key:0},ns={class:"text-gray-900 whitespace-pre-wrap"},rs={class:"bg-white rounded-lg p-6 w-full max-w-lg"},is={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},us={class:"md:col-span-2"},ds={class:"bg-white rounded-lg p-6 w-full max-w-3xl mx-4 max-h-[90vh] overflow-y-auto"},gs=["value"],bs=["value"],cs={class:"md:col-span-2"},ys=["value"],ms={class:"md:col-span-2 flex justify-end space-x-4 pt-4 border-t"},ps=["disabled"],fs={class:"bg-white rounded-lg p-6 w-full max-w-3xl mx-4 max-h-[90vh] overflow-y-auto"},xs=["value"],vs=["value"],ws=["value"],_s={class:"md:col-span-2"},ks=["value"],hs={class:"md:col-span-2 flex justify-end space-x-4 pt-4 border-t"},Cs=["disabled"],Bs={__name:"index",setup(ne){const H=Ke(),{success:N,error:c}=Ze(),{CASE_STATUS_OPTIONS:_,loadCasesByStatus:X,addCase:Y,updateCaseStatus:Z,updateBusinessLevel:ee}=Je(),{updateOne:te,convertToCase:se}=Ge(),{getUsers:q}=et();tt();const{get:L}=Xe(),E=g(""),S=g("all"),V=g("all"),x=g(!1),y=g(null),b=g([]),D=g([]),M=g([]),p=g([]),I=g(!1),z=g(!1),F=g(!1),T=g(!1),k=g(null),G=g(null),Q=g(null),B=g(!1),J=g(!1),ve=R(()=>b.value.map(o=>({id:o.id,title:`追蹤: ${o.customer_name||o.email||"N/A"}`,date:o.created_at,description:`案件狀態: ${o.case_status||"tracking"}`,caseId:o.id}))),re=[{value:"website",label:"官網"},{value:"line",label:"LINE"},{value:"facebook",label:"Facebook"},{value:"google",label:"Google廣告"},{value:"referral",label:"轉介紹"},{value:"other",label:"其他"}],W=g(1),le=g(10);R(()=>Math.ceil(ue.value.length/le.value));const ie=g([]),$=ae({loan_amount:null,loan_type:"",notes:""}),i=ae({case_status:"tracking",business_level:"A",created_at:new Date().toISOString().slice(0,16),assigned_to:null,source_channel:"",customer_name:"",line_name:"",line_id:"",consultation_items:"",website_domain:"",email:"",phone:""}),u=ae({case_status:"tracking",business_level:"A",created_at:"",assigned_to:null,source_channel:"",customer_name:"",line_name:"",line_id:"",consultation_items:"",website_domain:"",email:"",phone:""}),we=R(()=>[{key:"case_status",title:"案件狀態",sortable:!0,width:"160px"},{key:"business_level",title:"業務等級",sortable:!0,width:"100px"},{key:"case_number",title:"案件編號",sortable:!0,width:"140px",hidden:!0},{key:"datetime",title:"時間",sortable:!0,width:"140px"},{key:"assignee",title:"承辦業務",sortable:!0,width:"100px"},{key:"channel",title:"來源管道",sortable:!0,width:"100px"},{key:"customer_name",title:"姓名",sortable:!0,width:"120px"},{key:"line_info",title:"LINE資訊",sortable:!1,width:"160px"},{key:"purpose",title:"諮詢項目",sortable:!1,width:"120px"},{key:"website_name",title:"網站",sortable:!1,width:"140px"},{key:"contact_info",title:"聯絡資訊",sortable:!1,width:"160px",hidden:!0},{key:"location",title:"地區/地址",sortable:!1,width:"160px",hidden:!0},{key:"amount",title:"需求金額",sortable:!1,width:"120px",hidden:!0},{key:"custom_fields",title:"自定義欄位",sortable:!1,width:"140px",hidden:!0},{key:"actions",title:"操作",sortable:!1,width:"160px"}]),ue=R(()=>{let o=b.value;if(E.value&&E.value.length>=2){const e=E.value.toLowerCase();o=o.filter(s=>s.email?.toLowerCase().includes(e)||s.line_id?.toLowerCase().includes(e)||s.payload?.頁面_URL?.toLowerCase().includes(e)||s.source?.toLowerCase().includes(e)||s.assignee?.name?.toLowerCase().includes(e)||s.customer_name?.toLowerCase().includes(e))}return S.value&&S.value!=="all"&&(S.value==="null"?o=o.filter(e=>!e.assigned_to):o=o.filter(e=>e.assigned_to===parseInt(S.value))),V.value&&V.value!=="all"&&(o=o.filter(e=>je(e.payload?.頁面_URL||e.source)===V.value)),o}),K=R(()=>ie.value.filter(o=>o.is_visible)),j=async()=>{x.value=!0,y.value=null;try{const o=await X("tracking");b.value=o||[]}catch(o){y.value="載入追蹤案件數據失敗",console.error("Load tracking cases error:",o)}finally{x.value=!1}},_e=async()=>{try{const{success:o,users:e}=await q({per_page:250});o&&Array.isArray(e)&&(D.value=e)}catch(o){console.warn("Load users failed:",o)}},ke=async()=>{ie.value=[]},he=async()=>{try{const{data:o,error:e}=await L("/websites/options");!e&&Array.isArray(o)?(M.value=o,p.value=o.map(s=>({value:s.domain,label:s.name,website:s}))):console.warn("Failed to load websites from management system:",e)}catch(o){console.warn("Load websites failed:",o)}},Ce=o=>{E.value=o,W.value=1},De=o=>{W.value=o},Ue=o=>{le.value=o,W.value=1};let oe;Pe([E,S,V],()=>{clearTimeout(oe),oe=setTimeout(()=>{W.value=1},300)});const Se=o=>{k.value=o,I.value=!0},de=()=>{I.value=!1,k.value=null},Le=o=>{if(!o.customer_id){c("此案件尚未綁定客戶，請先建立/綁定客戶後再送件");return}G.value=o,Object.assign($,{loan_amount:null,loan_type:"",notes:""}),z.value=!0},ge=()=>{z.value=!1,G.value=null},Ve=async()=>{if(G.value){B.value=!0;try{const{error:o}=await se(G.value.id,$);o?c(o?.message||"轉換失敗"):(z.value=!1,await j(),N("案件轉換成功"))}catch(o){c("系統錯誤，請稍後再試"),console.error("Convert case error:",o)}finally{B.value=!1}}},Me=async(o,e)=>{(await Z(o.id,e,!0)).success&&(e!=="tracking"?await j():o.case_status=e)},Ae=async(o,e)=>{(await ee(o.id,e)).success&&(o.business_level=e)},Ee=()=>{Object.assign(i,{case_status:"tracking",business_level:"A",created_at:new Date().toISOString().slice(0,16),assigned_to:null,source_channel:"",customer_name:"",line_name:"",line_id:"",consultation_items:"",website_domain:"",email:"",phone:""}),T.value=!0},be=()=>{T.value=!1},Te=async()=>{J.value=!0;try{const o={channel:i.source_channel,case_status:i.case_status,business_level:i.business_level,created_at:i.created_at,assigned_to:i.assigned_to,email:i.email,phone:i.phone,line_id:i.line_id,customer_name:i.customer_name,payload:{頁面_URL:i.website_domain&&M.value.find(s=>s.domain===i.website_domain)?.url||"",LINE_ID:i.line_id,LINE顯示名稱:i.line_name,貸款需求:i.consultation_items}},e=await Y(o);e.success?(T.value=!1,await j(),N("追蹤案件新增成功")):c(e.error?.message||"新增失敗")}catch(o){c("系統錯誤，請稍後再試"),console.error("Add case error:",o)}finally{J.value=!1}},$e=o=>{Q.value=o.id,Object.assign(u,{case_status:o.case_status||"tracking",business_level:o.business_level||"A",created_at:o.created_at?new Date(o.created_at).toISOString().slice(0,16):new Date().toISOString().slice(0,16),assigned_to:o.assigned_to||null,source_channel:o.channel||"",customer_name:o.customer_name||"",line_name:o.payload?.LINE顯示名稱||"",line_id:o.line_id||"",consultation_items:o.payload?.貸款需求||"",website_domain:"",email:o.email||"",phone:o.phone||""}),F.value=!0},ce=()=>{F.value=!1,Q.value=null},Ne=async()=>{if(Q.value){B.value=!0;try{const o={channel:u.source_channel,case_status:u.case_status,business_level:u.business_level,assigned_to:u.assigned_to,email:u.email,phone:u.phone,line_id:u.line_id,customer_name:u.customer_name,payload:{頁面_URL:u.website_domain&&M.value.find(s=>s.domain===u.website_domain)?.url||"",LINE_ID:u.line_id,LINE顯示名稱:u.line_name,貸款需求:u.consultation_items}},{error:e}=await te(Q.value,o);e?c(e?.message||"更新失敗"):(F.value=!1,await j(),N("案件更新成功"))}catch(o){c("系統錯誤，請稍後再試"),console.error("Update case error:",o)}finally{B.value=!1}}},je=o=>{try{return new URL(o).hostname}catch{return o||""}},Oe=o=>{const e=new Date(o.created_at),s=e.getFullYear().toString().slice(-2),m=String(e.getMonth()+1).padStart(2,"0"),ze=String(e.getDate()).padStart(2,"0"),Fe=String(o.id).padStart(3,"0");return`CASE${s}${m}${ze}${Fe}`},{getWebsiteInfo:ye}=Qe(M),me=o=>new Date(o).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit"}),pe=o=>new Date(o).toLocaleTimeString("zh-TW",{hour:"2-digit",minute:"2-digit"}),Ie=(o,e)=>e.type==="multiselect"?Array.isArray(o)?o.join(", "):o||"-":e.type==="boolean"?o?"是":"否":o??"-";return Re(async()=>{await Promise.all([_e(),j(),ke(),he()])}),qe(()=>{clearTimeout(oe)}),We({title:"追蹤管理 - 貸款案件管理系統"}),(o,e)=>(n(),a("div",xt,[t("div",vt,[e[31]||(e[31]=t("div",null,[t("h1",{class:"text-3xl font-bold text-gray-900"},"追蹤管理"),t("p",{class:"text-gray-600 mt-2"},"管理客戶追蹤狀態、行事曆排程和案件處理")],-1)),t("button",{onClick:Ee,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-gray-600 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500"},[P(l(st),{class:"-ml-1 mr-2 h-5 w-5","aria-hidden":"true"}),e[30]||(e[30]=A(" 新增案件 ",-1))])]),P(ft,{events:l(ve)},null,8,["events"]),P(He,{title:"追蹤案件列表",columns:l(we),data:l(ue),loading:l(x),error:l(y),"search-query":l(E),"search-placeholder":"搜尋姓名/手機/Email/LINE/網站... (至少2個字符)","show-search-icon":!1,"current-page":l(W),"items-per-page":l(le),"loading-text":"載入中...","empty-text":"沒有追蹤中的案件",onSearch:Ce,onRefresh:j,onRetry:j,onPageChange:De,onPageSizeChange:Ue},{filters:U(()=>[l(H).hasPermission&&l(H).hasPermission("customer_management")?d((n(),a("select",{key:0,"onUpdate:modelValue":e[0]||(e[0]=s=>xe(S)?S.value=s:null),class:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500"},[e[32]||(e[32]=t("option",{value:"all"},"全部承辦",-1)),e[33]||(e[33]=t("option",{value:"null"},"未指派",-1)),(n(!0),a(v,null,w(l(D),s=>(n(),a("option",{key:s.id,value:s.id},r(s.name),9,wt))),128))],512)),[[h,l(S)]]):C("",!0),d(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>xe(V)?V.value=s:null),class:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500"},[e[34]||(e[34]=t("option",{value:"all"},"全部網站",-1)),(n(!0),a(v,null,w(l(p),s=>(n(),a("option",{key:s.value,value:s.value},r(s.label),9,_t))),128))],512),[[h,l(V)]])]),"cell-case_status":U(({item:s})=>[t("select",{value:s.case_status||"tracking",onChange:m=>Me(s,m.target.value),class:"w-full px-1 py-0.5 text-xs border border-gray-300 rounded bg-white text-gray-900 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"},[(n(!0),a(v,null,w(l(_),m=>(n(),a("option",{key:m.value,value:m.value},r(m.label),9,ht))),128))],40,kt)]),"cell-business_level":U(({item:s})=>[t("select",{value:s.business_level||"A",onChange:m=>Ae(s,m.target.value),class:"w-full px-1 py-0.5 text-xs border border-gray-300 rounded bg-white text-gray-900 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"},[...e[35]||(e[35]=[t("option",{value:"A"},"A級",-1),t("option",{value:"B"},"B級",-1),t("option",{value:"C"},"C級",-1)])],40,Ct)]),"cell-case_number":U(({item:s})=>[t("div",Dt,r(Oe(s)),1)]),"cell-website_name":U(({item:s})=>[t("span",Ut,r(l(ye)(s.payload?.頁面_URL||s.source).name),1)]),"cell-channel":U(({item:s})=>[t("span",St,r(s.channel==="wp_form"?"網站表單":s.channel==="lineoa"?"官方賴":s.channel==="email"?"Email":s.channel==="phone"?"電話":s.channel||"-"),1)]),"cell-datetime":U(({item:s})=>[t("div",null,[t("div",Lt,r(me(s.created_at)),1),t("div",Vt,r(pe(s.created_at)),1)])]),"cell-assignee":U(({item:s})=>[t("div",Mt,[t("span",At,r(s.assignee?.name||"未指派"),1)])]),"cell-line_info":U(({item:s})=>[s.line_user_info&&s.is_line_user_id?(n(),a("div",Et,[s.line_user_info.picture_url?(n(),a("img",{key:0,src:s.line_user_info.picture_url,alt:s.line_user_info.display_name||"LINE用戶",class:"w-6 h-6 rounded-full object-cover",onError:e[2]||(e[2]=m=>m.target.style.display="none")},null,40,Tt)):(n(),a("div",$t," L ")),t("div",Nt,[t("div",jt,[t("span",Ot,r(s.line_user_info.display_name||"未設定名稱"),1)])])])):s.line_id&&!s.is_line_user_id?(n(),a("div",It,[e[36]||(e[36]=t("div",{class:"w-6 h-6 rounded-full bg-gray-400 flex items-center justify-center text-white text-xs"}," @ ",-1)),t("span",zt,r(s.line_id),1)])):(n(),a("div",Ft," 未綁定 "))]),"cell-custom_fields":U(({item:s})=>[l(K).length>0?(n(),a("div",Bt,[(n(!0),a(v,null,w(l(K).slice(0,2),m=>(n(),a("div",{key:m.id,class:"text-xs"},[t("span",Pt,r(m.label)+":",1),t("span",Rt,r(Ie(s.payload?.[m.key],m)),1)]))),128)),l(K).length>2?(n(),a("div",qt," +"+r(l(K).length-2)+" 個欄位 ",1)):C("",!0)])):(n(),a("span",Wt,"無自定義欄位"))]),"cell-actions":U(({item:s})=>[t("div",Ht,[t("button",{onClick:m=>Se(s),class:"group relative inline-flex items-center justify-center p-2 text-blue-600 hover:text-white hover:bg-blue-600 rounded-lg transition-all duration-200",title:"查看詳情"},[P(l(lt),{class:"w-4 h-4"}),e[37]||(e[37]=t("div",{class:"absolute bottom-full mb-2 hidden group-hover:block px-2 py-1 text-xs text-white bg-gray-900 rounded whitespace-nowrap z-10"}," 查看詳情 ",-1))],8,Yt),t("button",{onClick:m=>$e(s),class:"group relative inline-flex items-center justify-center p-2 text-gray-600 hover:text-white hover:bg-gray-600 rounded-lg transition-all duration-200",title:"編輯"},[P(l(Ye),{class:"w-4 h-4"}),e[38]||(e[38]=t("div",{class:"absolute bottom-full mb-2 hidden group-hover:block px-2 py-1 text-xs text-white bg-gray-900 rounded whitespace-nowrap z-10"}," 編輯 ",-1))],8,Gt),s.customer_id?(n(),a("button",{key:0,onClick:m=>Le(s),class:"group relative inline-flex items-center justify-center p-2 text-purple-600 hover:text-white hover:bg-purple-600 rounded-lg transition-all duration-200",title:"轉送件"},[P(l(ot),{class:"w-4 h-4"}),e[39]||(e[39]=t("div",{class:"absolute bottom-full mb-2 hidden group-hover:block px-2 py-1 text-xs text-white bg-gray-900 rounded whitespace-nowrap z-10"}," 轉送件 ",-1))],8,Qt)):C("",!0)])]),_:1},8,["columns","data","loading","error","search-query","current-page","items-per-page"]),l(I)?(n(),a("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 mt-0",onClick:O(de,["self"])},[t("div",Jt,[t("div",{class:"flex justify-between items-center mb-4"},[e[40]||(e[40]=t("h3",{class:"text-lg font-semibold text-gray-900"},"案件詳情",-1)),t("button",{onClick:de,class:"text-gray-400 hover:text-gray-600"}," ✕ ")]),l(k)?(n(),a("div",Kt,[t("div",Xt,[t("div",null,[e[41]||(e[41]=t("label",{class:"block text-sm font-medium text-gray-700"},"網站",-1)),t("p",Zt,r(l(ye)(l(k).payload?.頁面_URL||l(k).source).name),1)]),t("div",null,[e[42]||(e[42]=t("label",{class:"block text-sm font-medium text-gray-700"},"來源管道",-1)),t("p",es,r(l(k).channel||"wp_form"),1)]),t("div",null,[e[43]||(e[43]=t("label",{class:"block text-sm font-medium text-gray-700"},"時間",-1)),t("p",ts,r(me(l(k).created_at))+" "+r(pe(l(k).created_at)),1)]),t("div",null,[e[44]||(e[44]=t("label",{class:"block text-sm font-medium text-gray-700"},"承辦業務",-1)),t("p",ss,r(l(k).assignee?.name||"未指派"),1)]),t("div",null,[e[45]||(e[45]=t("label",{class:"block text-sm font-medium text-gray-700"},"Email",-1)),t("p",ls,r(l(k).email||"未提供"),1)]),t("div",null,[e[46]||(e[46]=t("label",{class:"block text-sm font-medium text-gray-700"},"LINE ID",-1)),t("p",os,r(l(k).line_id||"未提供"),1)])]),l(k).notes?(n(),a("div",as,[e[47]||(e[47]=t("label",{class:"block text-sm font-medium text-gray-700"},"備註",-1)),t("p",ns,r(l(k).notes),1)])):C("",!0)])):C("",!0)])])):C("",!0),l(z)?(n(),a("div",{key:1,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 mt-0",onClick:O(ge,["self"])},[t("div",rs,[e[52]||(e[52]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"送件（建立案件）",-1)),t("form",{onSubmit:O(Ve,["prevent"]),class:"space-y-3"},[t("div",is,[t("div",null,[e[48]||(e[48]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"貸款金額",-1)),d(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>l($).loan_amount=s),required:"",type:"number",min:"0",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[f,l($).loan_amount,void 0,{number:!0}]])]),t("div",null,[e[49]||(e[49]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"貸款類型",-1)),d(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>l($).loan_type=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[f,l($).loan_type]])]),t("div",us,[e[50]||(e[50]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"備註",-1)),d(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=s=>l($).notes=s),rows:"2",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[f,l($).notes]])])]),t("div",{class:"flex justify-end space-x-3 pt-2"},[t("button",{type:"button",class:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",onClick:ge},"取消"),e[51]||(e[51]=t("button",{type:"submit",class:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700"},"送件",-1))])],32)])])):C("",!0),l(T)?(n(),a("div",{key:2,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 mt-0",onClick:O(be,["self"])},[t("div",ds,[e[71]||(e[71]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"新增追蹤案件",-1)),t("form",{onSubmit:O(Te,["prevent"]),class:"grid grid-cols-1 md:grid-cols-2 gap-4"},[t("div",null,[e[54]||(e[54]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"案件狀態",-1)),d(t("select",{"onUpdate:modelValue":e[6]||(e[6]=s=>l(i).case_status=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-500",disabled:""},[...e[53]||(e[53]=[t("option",{value:"tracking"},"追蹤中",-1)])],512),[[h,l(i).case_status]])]),t("div",null,[e[56]||(e[56]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"業務等級",-1)),d(t("select",{"onUpdate:modelValue":e[7]||(e[7]=s=>l(i).business_level=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-gray-500 focus:border-gray-500"},[...e[55]||(e[55]=[t("option",{value:"A"},"A級",-1),t("option",{value:"B"},"B級",-1),t("option",{value:"C"},"C級",-1)])],512),[[h,l(i).business_level]])]),t("div",null,[e[57]||(e[57]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"時間",-1)),d(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>l(i).created_at=s),type:"datetime-local",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-500",readonly:""},null,512),[[f,l(i).created_at]])]),t("div",null,[e[59]||(e[59]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"承辦業務",-1)),d(t("select",{"onUpdate:modelValue":e[9]||(e[9]=s=>l(i).assigned_to=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-gray-500 focus:border-gray-500"},[e[58]||(e[58]=t("option",{value:""},"未指派",-1)),(n(!0),a(v,null,w(l(D),s=>(n(),a("option",{key:s.id,value:s.id},r(s.name),9,gs))),128))],512),[[h,l(i).assigned_to]])]),t("div",null,[e[61]||(e[61]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},[A("來源管道 "),t("span",{class:"text-red-500"},"*")],-1)),d(t("select",{"onUpdate:modelValue":e[10]||(e[10]=s=>l(i).source_channel=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-gray-500 focus:border-gray-500",required:""},[e[60]||(e[60]=t("option",{value:""},"請選擇來源管道",-1)),(n(),a(v,null,w(re,s=>t("option",{key:s.value,value:s.value},r(s.label),9,bs)),64))],512),[[h,l(i).source_channel]])]),t("div",null,[e[62]||(e[62]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},[A("姓名 "),t("span",{class:"text-red-500"},"*")],-1)),d(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>l(i).customer_name=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-gray-500 focus:border-gray-500",required:""},null,512),[[f,l(i).customer_name]])]),t("div",null,[e[63]||(e[63]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"LINE顯示名稱",-1)),d(t("input",{"onUpdate:modelValue":e[12]||(e[12]=s=>l(i).line_name=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-gray-500 focus:border-gray-500"},null,512),[[f,l(i).line_name]])]),t("div",null,[e[64]||(e[64]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"LINE ID",-1)),d(t("input",{"onUpdate:modelValue":e[13]||(e[13]=s=>l(i).line_id=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-gray-500 focus:border-gray-500"},null,512),[[f,l(i).line_id]])]),t("div",cs,[e[65]||(e[65]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"諮詢項目",-1)),d(t("textarea",{"onUpdate:modelValue":e[14]||(e[14]=s=>l(i).consultation_items=s),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-gray-500 focus:border-gray-500",placeholder:"請描述客戶的諮詢需求..."},null,512),[[f,l(i).consultation_items]])]),t("div",null,[e[67]||(e[67]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"網站",-1)),d(t("select",{"onUpdate:modelValue":e[15]||(e[15]=s=>l(i).website_domain=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-gray-500 focus:border-gray-500"},[e[66]||(e[66]=t("option",{value:""},"請選擇網站",-1)),(n(!0),a(v,null,w(l(M),s=>(n(),a("option",{key:s.id,value:s.domain},r(s.name),9,ys))),128))],512),[[h,l(i).website_domain]])]),e[70]||(e[70]=t("div",null,null,-1)),t("div",null,[e[68]||(e[68]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"電子郵件",-1)),d(t("input",{"onUpdate:modelValue":e[16]||(e[16]=s=>l(i).email=s),type:"email",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-gray-500 focus:border-gray-500"},null,512),[[f,l(i).email]])]),t("div",null,[e[69]||(e[69]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"手機",-1)),d(t("input",{"onUpdate:modelValue":e[17]||(e[17]=s=>l(i).phone=s),type:"tel",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-gray-500 focus:border-gray-500"},null,512),[[f,l(i).phone]])]),t("div",ms,[t("button",{type:"button",class:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",onClick:be},"取消"),t("button",{type:"submit",class:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",disabled:l(J)},r(l(J)?"新增中...":"新增"),9,ps)])],32)])])):C("",!0),l(F)?(n(),a("div",{key:3,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 mt-0",onClick:O(ce,["self"])},[t("div",fs,[e[89]||(e[89]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"編輯追蹤案件",-1)),t("form",{onSubmit:O(Ne,["prevent"]),class:"grid grid-cols-1 md:grid-cols-2 gap-4"},[t("div",null,[e[72]||(e[72]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"案件狀態",-1)),d(t("select",{"onUpdate:modelValue":e[18]||(e[18]=s=>l(u).case_status=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-gray-500 focus:border-gray-500"},[(n(!0),a(v,null,w(l(_),s=>(n(),a("option",{key:s.value,value:s.value},r(s.label),9,xs))),128))],512),[[h,l(u).case_status]])]),t("div",null,[e[74]||(e[74]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"業務等級",-1)),d(t("select",{"onUpdate:modelValue":e[19]||(e[19]=s=>l(u).business_level=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-gray-500 focus:border-gray-500"},[...e[73]||(e[73]=[t("option",{value:"A"},"A級",-1),t("option",{value:"B"},"B級",-1),t("option",{value:"C"},"C級",-1)])],512),[[h,l(u).business_level]])]),t("div",null,[e[75]||(e[75]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"時間",-1)),d(t("input",{"onUpdate:modelValue":e[20]||(e[20]=s=>l(u).created_at=s),type:"datetime-local",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-gray-500 focus:border-gray-500"},null,512),[[f,l(u).created_at]])]),t("div",null,[e[77]||(e[77]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"承辦業務",-1)),d(t("select",{"onUpdate:modelValue":e[21]||(e[21]=s=>l(u).assigned_to=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-gray-500 focus:border-gray-500"},[e[76]||(e[76]=t("option",{value:""},"未指派",-1)),(n(!0),a(v,null,w(l(D),s=>(n(),a("option",{key:s.id,value:s.id},r(s.name),9,vs))),128))],512),[[h,l(u).assigned_to]])]),t("div",null,[e[79]||(e[79]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},[A("來源管道 "),t("span",{class:"text-red-500"},"*")],-1)),d(t("select",{"onUpdate:modelValue":e[22]||(e[22]=s=>l(u).source_channel=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-gray-500 focus:border-gray-500",required:""},[e[78]||(e[78]=t("option",{value:""},"請選擇來源管道",-1)),(n(),a(v,null,w(re,s=>t("option",{key:s.value,value:s.value},r(s.label),9,ws)),64))],512),[[h,l(u).source_channel]])]),t("div",null,[e[80]||(e[80]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},[A("姓名 "),t("span",{class:"text-red-500"},"*")],-1)),d(t("input",{"onUpdate:modelValue":e[23]||(e[23]=s=>l(u).customer_name=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-gray-500 focus:border-gray-500",required:""},null,512),[[f,l(u).customer_name]])]),t("div",null,[e[81]||(e[81]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"LINE顯示名稱",-1)),d(t("input",{"onUpdate:modelValue":e[24]||(e[24]=s=>l(u).line_name=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-gray-500 focus:border-gray-500"},null,512),[[f,l(u).line_name]])]),t("div",null,[e[82]||(e[82]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"LINE ID",-1)),d(t("input",{"onUpdate:modelValue":e[25]||(e[25]=s=>l(u).line_id=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-gray-500 focus:border-gray-500"},null,512),[[f,l(u).line_id]])]),t("div",_s,[e[83]||(e[83]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"諮詢項目",-1)),d(t("textarea",{"onUpdate:modelValue":e[26]||(e[26]=s=>l(u).consultation_items=s),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-gray-500 focus:border-gray-500",placeholder:"請描述客戶的諮詢需求..."},null,512),[[f,l(u).consultation_items]])]),t("div",null,[e[85]||(e[85]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"網站",-1)),d(t("select",{"onUpdate:modelValue":e[27]||(e[27]=s=>l(u).website_domain=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-gray-500 focus:border-gray-500"},[e[84]||(e[84]=t("option",{value:""},"請選擇網站",-1)),(n(!0),a(v,null,w(l(M),s=>(n(),a("option",{key:s.id,value:s.domain},r(s.name),9,ks))),128))],512),[[h,l(u).website_domain]])]),e[88]||(e[88]=t("div",null,null,-1)),t("div",null,[e[86]||(e[86]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"電子郵件",-1)),d(t("input",{"onUpdate:modelValue":e[28]||(e[28]=s=>l(u).email=s),type:"email",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-gray-500 focus:border-gray-500"},null,512),[[f,l(u).email]])]),t("div",null,[e[87]||(e[87]=t("label",{class:"block text-sm font-semibold text-gray-900 mb-1"},"手機",-1)),d(t("input",{"onUpdate:modelValue":e[29]||(e[29]=s=>l(u).phone=s),type:"tel",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-gray-500 focus:border-gray-500"},null,512),[[f,l(u).phone]])]),t("div",hs,[t("button",{type:"button",class:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",onClick:ce},"取消"),t("button",{type:"submit",class:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",disabled:l(B)},r(l(B)?"更新中...":"更新"),9,Cs)])],32)])])):C("",!0)]))}};export{Bs as default};
